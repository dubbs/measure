function Lexer(a){function b(){for(var a=[],b=0,c=this.state,e=this.index,f=this.input,g=0,h=d.length;h>g;g++){var i=d[g],j=i.start,k=j.length;if(!k||j.indexOf(c)>=0||c%2&&1===k&&!j[0]){var l=i.pattern;l.lastIndex=e;var m=l.exec(f);if(m&&m.index===e){var n=a.push({result:m,action:i.action,length:m[0].length});for(i.global&&(b=n);--n>b;){var o=n-1;if(a[n].length>a[o].length){var p=a[n];a[n]=a[o],a[o]=p}}}}}return a}"function"!=typeof a&&(a=Lexer.defunct);var c=[],d=[],e=0;this.state=0,this.index=0,this.input="",this.addRule=function(a,b,c){var e=a.global;if(!e){var f="g";a.multiline&&(f+="m"),a.ignoreCase&&(f+="i"),a=new RegExp(a.source,f)}return"[object Array]"!==Object.prototype.toString.call(c)&&(c=[0]),d.push({pattern:a,global:e,action:b,start:c}),this},this.setInput=function(a){return e=0,this.state=0,this.index=0,this.input=a,this},this.lex=function(){if(c.length)return c.shift();for(this.reject=!0;this.index<=this.input.length;){for(var d=b.call(this).splice(e),f=this.index;d.length&&this.reject;){var g=d.shift(),h=g.result,i=g.length;this.index+=i,this.reject=!1,e++;var j=g.action.apply(this,h);if(this.reject)this.index=h.index;else if("undefined"!=typeof j)switch(Object.prototype.toString.call(j)){case"[object Array]":c=j.slice(1),j=j[0];default:return i&&(e=0),j}}var k=this.input;if(f<k.length)if(this.reject){e=0;var j=a.call(this,k.charAt(this.index++));if("undefined"!=typeof j)return"[object Array]"===Object.prototype.toString.call(j)?(c=j.slice(1),j[0]):j}else this.index!==f&&(e=0),this.reject=!0;else{if(!d.length)break;this.reject=!0}}}}"object"==typeof module&&"object"==typeof module.exports&&(module.exports=Lexer),Lexer.defunct=function(a){throw new Error("Unexpected character at index "+(this.index-1)+": "+a)},function(a){function b(a){return Math.round(100*(a+1e-5))/100}var c=3785.41,d=29.5735,e={teaspoons:b(d/6),tablespoons:b(d/2),fluidounces:b(d),shots:b(1.5*d),gills:b(4*d),cups:b(c/16),pints:b(c/8),fifths:b(c/5),quarts:b(c/4),gallons:b(c)},f=453.592,g={drams:b(f/256),ounces:b(f/16),pounds:b(f),quarters:b(25*f)};a.MeasureVolumeUSCustomary=e,a.MeasureMassUSCustomary=g}(this),function(a){function b(a){return Math.round(100*(a+1e-5))/100}var c=4546.09,d=28.4131,e={teaspoons:b(d/6),tablespoons:b(d/2),fluidounces:b(d),shots:b(1.5*d),gills:b(c/32),cups:b(c/16),pints:b(c/8),fifths:b(c/5),quarts:b(c/4),gallons:b(c)};a.MeasureVolumeImperial=e}(this),function(window){function Measure(a){this.ml=a&&a.ml||0,this.g=a&&a.g||0}Measure.prototype.milliliters=function(){return this.ml},Measure.prototype.centiliters=function(){return this.ml/10},Measure.prototype.deciliters=function(){return this.ml/100},Measure.prototype.liters=function(){return this.ml/1e3},Measure.prototype.decaliters=function(){return this.ml/1e4},Measure.prototype.hectoliters=function(){return this.ml/1e5},Measure.prototype.kiloliters=function(){return this.ml/1e6},Measure.prototype.drops=function(){return this.totalByUnit("drops")},Measure.prototype.teaspoons=function(){return this.totalByUnit("teaspoons")},Measure.prototype.tablespoons=function(){return this.totalByUnit("tablespoons")},Measure.prototype.fluidounces=function(){return this.totalByUnit("fluidounces")},Measure.prototype.jiggers=function(){return this.totalByUnit("jiggers")},Measure.prototype.gills=function(){return this.totalByUnit("gills")},Measure.prototype.cups=function(){return this.totalByUnit("cups")},Measure.prototype.pints=function(){return this.totalByUnit("pints")},Measure.prototype.fifths=function(){return this.totalByUnit("fifths")},Measure.prototype.quarts=function(){return this.totalByUnit("quarts")},Measure.prototype.gallons=function(){return this.totalByUnit("gallons")},Measure.prototype.grams=function(){return this.g},Measure.prototype.drams=function(){return this.totalMassByUnit("drams")},Measure.prototype.ounces=function(){return this.totalMassByUnit("ounces")},Measure.prototype.pounds=function(){return this.totalMassByUnit("pounds")},Measure.prototype.quarters=function(){return this.totalMassByUnit("quarters")},Measure.prototype.units=function(){return this.totalByUnit("units")},Measure.prototype.add=function(a){var b=Measure.parseOptionsFromString(a);return b.ml&&(this.ml+=b.ml),b.g&&(this.g+=b.g),this},Measure.prototype.subtract=function(a){var b=Measure.parseOptionsFromString(a);return b.ml&&(this.ml-=b.ml),b.g&&(this.g-=b.g),this},Measure.prototype.multiply=function(a){return this.ml*=a,this.g*=a,this},Measure.prototype.divide=function(a){return this.ml/=a,this.g/=a,this},Measure.prototype.totalByUnit=function(a){var b=this.ml/Measure.volume[a];return Math.round(100*(b+1e-5))/100},Measure.prototype.totalMassByUnit=function(a){var b=this.g/Measure.mass[a];return Math.round(100*(b+1e-5))/100},Measure.parseOptionsFromString=function(input){var lexer=new Lexer,num=0,obj={ml:0,g:0},volume=this.volume,mass=this.mass;return lexer.addRule(/[0-9.\/ -]+/g,function(lexeme){lexeme=lexeme.trim().replace("-"," ").split(" ").join("+"),num=eval(lexeme)}),lexer.addRule(/millilit(re|er)s?|ml/g,function(){obj.ml+=num}),lexer.addRule(/centilit(re|er)s?|cl/g,function(){obj.ml+=10*num}),lexer.addRule(/decilit(re|er)s?|dl/g,function(){obj.ml+=100*num}),lexer.addRule(/lit(re|er)s?|l\s|l$/g,function(){obj.ml+=1e3*num}),lexer.addRule(/decalit(re|er)s?|dal/g,function(){obj.ml+=1e4*num}),lexer.addRule(/hectolit(re|er)s?|hl/g,function(){obj.ml+=1e5*num}),lexer.addRule(/kilolit(re|er)s?|kl/g,function(){obj.ml+=1e6*num}),lexer.addRule(/(teaspoons?|tsp\.|t\.)/g,function(){obj.ml+=num*volume.teaspoons}),lexer.addRule(/(tablespoons?|tbsp\.|T\.)/g,function(){obj.ml+=num*volume.tablespoons}),lexer.addRule(/(fluidounces?|fl\.oz\.)/g,function(){obj.ml+=num*volume.fluidounces}),lexer.addRule(/(shots?)/g,function(){obj.ml+=num*volume.shots}),lexer.addRule(/(gills?|gi\.)/g,function(){obj.ml+=num*volume.gills}),lexer.addRule(/(cups?|C)/g,function(){obj.ml+=num*volume.cups}),lexer.addRule(/(pints?|pt\.)/g,function(){obj.ml+=num*volume.pints}),lexer.addRule(/(fifths?)/g,function(){obj.ml+=num*volume.fifths}),lexer.addRule(/(quarts?\s|quart$|qt\.)/g,function(){obj.ml+=num*volume.quarts}),lexer.addRule(/(gallons?|gal\.)/g,function(){obj.ml+=num*volume.gallons}),lexer.addRule(/(kilograms?|kg\.?)/g,function(){obj.g+=1e3*num}),lexer.addRule(/(grams?|g\.?)/g,function(){obj.g+=num}),lexer.addRule(/(drams?|dr)/g,function(){obj.g+=num*mass.drams}),lexer.addRule(/(ounces?|oz\.)/g,function(){obj.g+=num*mass.ounces}),lexer.addRule(/(pounds?|lbs\.?)/g,function(){obj.g+=num*mass.pounds}),lexer.addRule(/(quarters?|qr)/g,function(){obj.g+=num*mass.quarters}),lexer.addRule(/[^0-9]+/g,function(){0===obj.ml&&0===obj.g&&(obj.units=num)}),lexer.addRule(/\s/g,function(){}),lexer.setInput(input),lexer.lex(),0===obj.ml&&delete obj.ml,0===obj.g&&delete obj.g,obj},Measure.createFromString=function(a){return a=Measure.parseOptionsFromString(a),new Measure(a)},Measure.createFromObject=function(a){return new Measure(a)};var measure=function(a){return"string"==typeof a?Measure.createFromString(a):"object"==typeof a?Measure.createFromObject(a):new Measure};Measure.volume=window.MeasureVolumeUSCustomary,Measure.mass=window.MeasureMassUSCustomary,window.measure=measure,window.Measure=Measure}(this);